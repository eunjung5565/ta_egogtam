<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TA 에고그램 자아상태 검사</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #4f46e5; --bg: #f3f4f6; --white: #ffffff; }
        body { font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif; background-color: var(--bg); margin: 0; padding: 20px; color: #1f2937; }
        .container { max-width: 700px; margin: 0 auto; background: var(--white); padding: 40px; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--primary); margin-bottom: 10px; }
        .info { text-align: center; font-size: 0.9em; color: #6b7280; margin-bottom: 40px; line-height: 1.5; }
        .q-row { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #f3f4f6; }
        .q-text { font-size: 1.1em; font-weight: 600; margin-bottom: 15px; }
        .options { display: flex; justify-content: space-between; gap: 5px; }
        .option { flex: 1; text-align: center; }
        .option input { display: none; }
        .option label { display: block; padding: 10px 5px; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; cursor: pointer; font-size: 0.85em; transition: 0.2s; }
        .option label:hover { background: #f3f4f6; }
        .option input:checked + label { background: var(--primary); color: white; border-color: var(--primary); }
        button { width: 100%; padding: 20px; background: var(--primary); color: white; border: none; border-radius: 12px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 20px; transition: 0.2s; }
        button:hover { background: #4338ca; }
        #result { display: none; margin-top: 40px; }
        .chart-container { margin-top: 30px; position: relative; height: 400px; }
        .score-summary { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 30px; }
        .score-item { background: #f9fafb; padding: 15px; border-radius: 10px; text-align: center; }
        .score-label { font-size: 0.9em; color: #6b7280; margin-bottom: 5px; }
        .score-value { font-size: 1.5em; font-weight: bold; color: var(--primary); }
    </style>
</head>
<body>

<div class="container">
    <h1>에고그램(TA) 진단</h1>
    <p class="info">각 문항을 읽고 자신에게 해당되는 정도를 선택해 주세요.<br>(1)전혀 그렇지 않다 ~ (5)매우 그렇다</p>
    
    <div id="quiz"></div>
    <button onclick="calculate()">결과 확인하기</button>

    <div id="result">
        <hr>
        <h2 style="text-align: center;">나의 자아상태 그래프</h2>
        <div class="chart-container">
            <canvas id="radarChart"></canvas>
        </div>
        <div class="score-summary" id="scoreSummary"></div>
    </div>
</div>

<script>
    const questions = [
        { id: 1, q: "다른 사람을 비판하기 보다 칭찬을 주로 한다", type: "NP" },
        { id: 2, q: "어떤 사건에 대해 잘 잘못을 가리지 않으면 마음이 편치 않다", type: "CP" },
        { id: 3, q: "어떤 일을 할 때 좀처럼 결심을 할 수 없다", type: "AC" },
        { id: 4, q: "명랑하게 행동하고 장난을 잘 친다", type: "FC" },
        { id: 5, q: "말과 행동을 할 때 냉정하고 침착하게 한다", type: "A" },
        { id: 6, q: "성격이 급하고 화를 잘 낸다", type: "CP" },
        { id: 7, q: "나보다는 타인의 입장을 먼저 생각한다", type: "NP" },
        { id: 8, q: "호기심이 강하고 창의적인 생각을 잘한다", type: "FC" },
        { id: 9, q: "정리정돈을 잘 하는 편이다", type: "A" },
        { id: 10, q: "표현력이 풍부하고 농담 하기를 좋아한다", type: "FC" },
        { id: 11, q: "내가 나서서 무엇을 하는 것 보다는 남이 시키는 것을 하는게 편하다", type: "AC" },
        { id: 12, q: "상대방의 이야기에 경청하고 공감하기를 잘한다", type: "NP" },
        { id: 13, q: "상대방의 실수에 엄격하다.", type: "CP" },
        { id: 14, q: "어려움에 처해 있는 사람을 보면 도와준다", type: "NP" },
        { id: 15, q: "주로 숫자나 자료를 근거해서 이야기 한다", type: "A" },
        { id: 16, q: "제멋대로 말하거나 내키는 대로 행동한다", type: "FC" },
        { id: 17, q: "후회하는 일에 대한 생각에 사로 잡힐 때가 많다", type: "AC" },
        { id: 18, q: "어떤 일을 하고 나서 죄책감이 들거나 자책하는 일이 많다", type: "AC" },
        { id: 19, q: "육하원칙에 따라 사고하고 설명한다.", type: "A" },
        { id: 20, q: "미래에 대하여 철저하게 계획하고 행동한다", type: "A" },
        { id: 21, q: "어떤 일을 할 때 적극적으로 나서지 못한다", type: "AC" },
        { id: 22, q: "사실에 입각해서 객관적으로 판단한다", type: "A" },
        { id: 23, q: "다른 사람의 부탁을 받으면 거절하지 못한다", type: "AC" },
        { id: 24, q: "주변사람의 의견 보다는 내 의견을 더 우선적으로 내세운다", type: "CP" },
        { id: 25, q: "봉사활동에 참여하는 것이 즐겁다", type: "NP" },
        { id: 26, q: "배려나 동정심이 강하다", type: "NP" },
        { id: 27, q: "신이 나면 도가 지나쳐서 실수를 하는 경우가 있다", type: "FC" },
        { id: 28, q: "타인의 장점보다 결점이 눈에 띈다", type: "CP" },
        { id: 29, q: "타인의 반대에 부딪치면 자신의 생각보다 타인의 말을 따른다", type: "AC" },
        { id: 30, q: "다른 사람에 대해 온화하고 관대하다", type: "NP" },
        { id: 31, q: "상대방의 말을 가로막고 내 생각을 먼저 말한다", type: "CP" },
        { id: 32, q: "노래 부르거나 춤추는 것을 좋아한다", type: "FC" },
        { id: 33, q: "계획을 세우고 나서 실행한다", type: "A" },
        { id: 34, q: "반드시' '당연히' 라는 말을 자주 사용한다", type: "CP" },
        { id: 35, q: "타인의 안색을 살피며 눈치를 잘 본다", type: "AC" },
        { id: 36, q: "장난스런 행동이나 농담을 잘 한다", type: "FC" },
        { id: 37, q: "현상을 관찰, 분석하고 합리적으로 의사결정을 한다", type: "A" },
        { id: 38, q: "오락이나 술 등 음식물을 만족할 때까지 취한다", type: "FC" },
        { id: 39, q: "열등감이 심하고 자신의 감정을 참고 억제한다", type: "AC" },
        { id: 40, q: "상냥하고 부드러우며 온화한 태도로 상대를 대한다", type: "NP" },
        { id: 41, q: "우선순위 대로 일하는 것을 좋아한다", type: "A" },
        { id: 42, q: "하고 싶은 말이 있어도 그것을 표현하거나 말 할 수가 없다", type: "AC" },
        { id: 43, q: "'~~해, '~~하지 않으면 안돼'하는 표현을 자주 사용한다", type: "CP" },
        { id: 44, q: "노는 분위기에 저항 없이 어울린다", type: "FC" },
        { id: 45, q: "타인의 눈물과 정에 약하다", type: "NP" },
        { id: 46, q: "대화를 할 때 감정에 얽매이지 않고 이성적으로 풀어간다", type: "A" },
        { id: 47, q: "부모나 상사가 시키는 대로 한다", type: "AC" },
        { id: 48, q: "타인의 반대에 부딪혀도 내 생각을 관철한다", type: "CP" },
        { id: 49, q: "와 멋있다. 우와, 등의 감탄사를 잘 쓴다", type: "FC" },
        { id: 50, q: "매사에 비판적이다", type: "CP" }
    ];

    const quizContainer = document.getElementById('quiz');
    const labels = ["전혀 아니다", "아니다", "그저 그렇다", "그렇다", "매우 그렇다"];

    questions.forEach(item => {
        const qHtml = `
            <div class="q-row">
                <div class="q-text">${item.id}. ${item.q}</div>
                <div class="options">
                    ${labels.map((label, i) => `
                        <div class="option">
                            <input type="radio" name="q${item.id}" id="q${item.id}_${i+1}" value="${i+1}">
                            <label for="q${item.id}_${i+1}">${label}</label>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
        quizContainer.innerHTML += qHtml;
    });

    let myChart = null;

    function calculate() {
        const scores = { CP: 0, NP: 0, A: 0, FC: 0, AC: 0 };
        let unanswered = [];

        questions.forEach(item => {
            const val = document.querySelector(`input[name="q${item.id}"]:checked`)?.value;
            if (val) scores[item.type] += parseInt(val);
            else unanswered.push(item.id);
        });

        if (unanswered.length > 0) {
            alert(`답하지 않은 문항이 있습니다: ${unanswered.join(', ')}`);
            return;
        }

        display(scores);
    }

    function display(scores) {
        document.getElementById('result').style.display = 'block';
        
        const fullNames = { 
            CP: "비판적 어버이", 
            NP: "양육적 어버이", 
            A: "성인", 
            FC: "자유로운 어린이", 
            AC: "순응하는 어린이" 
        };

        // 점수 요약 표시
        const summaryContainer = document.getElementById('scoreSummary');
        summaryContainer.innerHTML = '';
        for (let key in scores) {
            summaryContainer.innerHTML += `
                <div class="score-item">
                    <div class="score-label">${fullNames[key]}</div>
                    <div class="score-value">${scores[key]}점</div>
                </div>
            `;
        }

        // 레이더 차트 생성
        const ctx = document.getElementById('radarChart').getContext('2d');
        
        if (myChart) {
            myChart.destroy();
        }

        myChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: [
                    '비판적 어버이(CP)',
                    '양육적 어버이(NP)',
                    '성인(A)',
                    '자유로운 어린이(FC)',
                    '순응하는 어린이(AC)'
                ],
                datasets: [{
                    label: '나의 자아상태',
                    data: [scores.CP, scores.NP, scores.A, scores.FC, scores.AC],
                    backgroundColor: 'rgba(79, 70, 229, 0.2)',
                    borderColor: 'rgba(79, 70, 229, 1)',
                    borderWidth: 3,
                    pointBackgroundColor: 'rgba(79, 70, 229, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(79, 70, 229, 1)',
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 50,
                        min: 0,
                        ticks: {
                            stepSize: 10,
                            font: {
                                size: 12
                            }
                        },
                        pointLabels: {
                            font: {
                                size: 13,
                                weight: 'bold'
                            }
                        },
                        grid: {
                            color: 'rgba(0, 0, 0, 0.1)'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }
</script>
</body>
</html>
